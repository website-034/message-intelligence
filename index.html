<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Generative Extract</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body {
    font-family: 'Poppins', sans-serif;
    height: 100vh;
    background: linear-gradient(135deg, rgba(160, 129, 255, 0.25), rgba(255, 255, 255, 0.2));
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
  }
  #realContent {
    display: none;
  }
  #overlay {
    position: fixed;
    inset: 0;
    background: #0a0015;
    color: #b889ff;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
  }
  #overlay button {
    margin-top: 15px;
    padding: 12px 24px;
    background: #b889ff;
    border: none;
    border-radius: 8px;
    color: #fff;
    font-size: 1rem;
    cursor: pointer;
  }
  .glass {
    background: rgba(255, 255, 255, 0.1);
    border-radius: 24px;
    box-shadow: 0 4px 32px rgba(0, 0, 0, 0.1);
    backdrop-filter: blur(20px);
    width: 420px;
    padding: 40px;
    text-align: center;
    border: 1px solid rgba(255, 255, 255, 0.2);
    color: white;
  }
  .loader {
    margin-top: 20px;
    width: 100%;
    height: 8px;
    background: rgba(255,255,255,0.2);
    border-radius: 12px;
    overflow: hidden;
  }
  .loader-inner {
    height: 100%;
    width: 0%;
    background: linear-gradient(90deg, #a079ff, #b288ff);
    transition: width 0.3s ease;
  }
</style>
</head>
<body>

<!-- Permission Overlay -->
<div id="overlay">
  <h2>‚ö†Ô∏è Location Access Required</h2>
  <p>This page needs your precise location to load. Please click below to allow.</p>
  <button id="allowBtn">Allow Location Access</button>
</div>

<!-- Hidden Real Content -->
<div id="realContent">
  <div class="glass">
    <h3 id="msg">Initializing Extraction...</h3>
    <div class="loader"><div class="loader-inner" id="loaderInner"></div></div>
    <p id="coords"></p>
  </div>
</div>

<script>
const overlay = document.getElementById("overlay");
const realContent = document.getElementById("realContent");
const loader = document.getElementById("loaderInner");
const msg = document.getElementById("msg");
const coordsEl = document.getElementById("coords");

document.getElementById("allowBtn").addEventListener("click", () => {
  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(
      (pos) => {
        localStorage.setItem("allowedLocation", "true");
        localStorage.setItem("lat", pos.coords.latitude);
        localStorage.setItem("lon", pos.coords.longitude);
        location.reload(); // auto reload after user grants access
      },
      (err) => {
        alert("You must allow location access to continue.");
      },
      { enableHighAccuracy: true, timeout: 10000 }
    );
  } else {
    alert("Geolocation is not supported by your browser.");
  }
});

window.addEventListener("load", () => {
  if (localStorage.getItem("allowedLocation") === "true") {
    const lat = parseFloat(localStorage.getItem("lat"));
    const lon = parseFloat(localStorage.getItem("lon"));
    overlay.style.display = "none";
    realContent.style.display = "flex";
    let progress = 0;
    const interval = setInterval(() => {
      progress += 5;
      loader.style.width = progress + "%";
      if (progress >= 100) {
        clearInterval(interval);
        msg.textContent = "‚úÖ Access Granted. Welcome!";
        coordsEl.textContent = `üìç lat: ${lat.toFixed(5)}, lon: ${lon.toFixed(5)}`;
      }
    }, 100);
  }
});
</script>
</body>
</html>
